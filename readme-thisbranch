This is a quick-and-dirty merge. Please don't develop on top of it.
